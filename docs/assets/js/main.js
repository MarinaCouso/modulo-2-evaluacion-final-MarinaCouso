"use strict";let listSeries=[],favoriteSeries=[];const inputSearch=document.querySelector(".js-inputSearch"),btnSearch=document.querySelector(".js-btnSearch"),listSection=document.querySelector(".js-listSection"),form=document.querySelector(".js-form"),favoritesSection=document.querySelector(".js-favoritesSection"),getLocalStorage=()=>{const e=localStorage.getItem("favorites");null!==e&&(favoriteSeries=JSON.parse(e),paintFavorites())};getLocalStorage();const setLocalStorage=()=>{localStorage.setItem("favorites",JSON.stringify(favoriteSeries)),localStorage.setItem("list",JSON.stringify(listSeries))};function preventDefault(e){e.preventDefault()}let userSearch="";function getValue(){userSearch=inputSearch.value}function getImage(e){return null===e.show.image?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":e.show.image.medium}function addList(e){e.preventDefault,listSeries=[],fetch(`http://api.tvmaze.com/search/shows?q=${userSearch}`).then(e=>e.json()).then(e=>{for(let t=0;t<e.length;t++)listSeries.push({image:getImage(e[t]),name:e[t].show.name,id:e[t].show.id});paintSeries(),listenToList()})}function isInFavorites(e,t){for(let i=0;i<t.length;i++)if(t[i].id===e)return!0;return!1}function paintSeries(){listSection.innerHTML="";let e="";for(let t=0;t<listSeries.length;t++)isInFavorites(listSeries[t].id,favoriteSeries)?e+=`<article class="js-article main__list__div__article reverseColor" id="${listSeries[t].id}">`:e+=`<article class="js-article main__list__div__article" id="${listSeries[t].id}">`,e+=`<img src="${listSeries[t].image}" alt="Imagen de la serie ${listSeries[t].name}" />`,e+=`<h3>${listSeries[t].name}</h3>`,e+="</article>";listSection.innerHTML+=e}function listenToList(){const e=document.querySelectorAll(".js-article");for(const t of e)t.addEventListener("click",addToFavorites)}function listenToFavoriteRemoveAll(){document.querySelector(".js-btnRemoveAll").addEventListener("click",(function(){favoriteSeries=[],paintFavorites(),setLocalStorage()}))}function paintFavorites(){favoritesSection.innerHTML="";let e="";for(let t=0;t<favoriteSeries.length;t++)e+=`<article class="js-article div__article" id="${favoriteSeries[t].id}">`,e+=`<img class="div__article__img" src="${favoriteSeries[t].image}" alt="Imagen de la serie ${favoriteSeries[t].name}" />`,e+=`<h3 class="div__article__name">${favoriteSeries[t].name}</h3>`,e+=`<input class="js-btnRemove div__article__btnRemove" type="submit" value="x" id="${favoriteSeries[t].id}"/>`,e+="</article>";e+='<input class="js-btnRemoveAll div__btnRemoveAll" type="submit" value="Eliminar favoritas" />',favoritesSection.innerHTML+=e,listenToFavoriteRemove(),listenToFavoriteRemoveAll()}let clickListId=[];function addToFavorites(e){clickListId=parseInt(e.currentTarget.id);let t,i={};for(let e=0;e<listSeries.length;e++)listSeries[e].id===clickListId&&(i=listSeries[e]);for(const e of favoriteSeries)e.id===clickListId&&(t=e);if(void 0===t)e.currentTarget.classList.add("reverseColor"),favoriteSeries.push(i);else if(t.id!==i.id)e.currentTarget.classList.add("reverseColor"),favoriteSeries.push(i);else if(t.id===i.id)for(let i=0;i<favoriteSeries.length;i++)t.id===favoriteSeries[i].id&&(favoriteSeries.splice(i,1),e.currentTarget.setAttribute("class","js-article main__list__div__article"));paintFavorites(),setLocalStorage()}function listenToFavoriteRemove(){const e=document.querySelectorAll(".js-btnRemove");for(const t of e)t.addEventListener("click",removeFavorites)}function removeFavorites(e){let t=parseInt(e.currentTarget.id),i={};for(let e=0;e<favoriteSeries.length;e++)e===t&&(i=favoriteSeries[e]);let r="";for(let t=0;t<favoriteSeries.length;t++)favoriteSeries[t].id===i.id&&(r=e.currentTarget.parentElement,r.parentElement.removeChild(r));setLocalStorage()}inputSearch.addEventListener("keyup",getValue),btnSearch.addEventListener("click",addList),form.addEventListener("click",preventDefault),listSection.addEventListener("click",listenToList);